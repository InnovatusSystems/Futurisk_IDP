using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using Aspose.Pdf;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Text;
using System.Threading.Tasks;
using Smartreader_DLL;
using System.Windows.Forms;
using Spire.Xls;
using System.Data.SqlClient;
using System.Configuration;
using Syncfusion.XlsIO;
using System.Globalization;
using System.Text.RegularExpressions;
using IWorkbook = NPOI.SS.UserModel.IWorkbook;
using System.Diagnostics;

namespace Futurisk
{
    public partial class AckoInsurence : Form
    {
        static string Dir, Filepath, RDate, Result, Fileextn, DelFile, ProcName;

        private void btnBrowse_Click(object sender, EventArgs e)
        {
            lblSuccMsg.Text = "";

            if (DDInsurance.SelectedValue.ToString() != "0" && DDsales.SelectedValue.ToString() != "0" && DDService.SelectedValue.ToString() != "0" && (DDMonth.SelectedIndex != -1 && DDMonth.SelectedIndex != 0))
            {

                btnConvert.Enabled = true;
                btnCancel.Enabled = true;
                DialogResult dr = openFileDialog1.ShowDialog();

                if (dr.Equals(DialogResult.OK))
                {
                    //lblFile1.Text = openFileDialog1.FileName;

                    btnBrowse.Enabled = true;
                    btnCancel.Enabled = true;
                    btnConvert.Enabled = true;
                    Dir = System.IO.Path.GetDirectoryName(openFileDialog1.FileName);
                    Filename = System.IO.Path.GetFileNameWithoutExtension(openFileDialog1.FileName);
                    Filepath = openFileDialog1.FileName;
                    Filewithext = System.IO.Path.GetFileName(openFileDialog1.FileName);
                    Fileextn = System.IO.Path.GetExtension(openFileDialog1.FileName);

                    txtfile.Text = Filewithext;
                    txtfile.ForeColor = System.Drawing.Color.Black;
                    Fileinfo.Filename = Filewithext;
                    if (Fileinfo.InsurerCode == "UIIC")
                    {
                        Fileinfo.TName = "UnitedExcelTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "NIAC")
                    {
                        Fileinfo.TName = "NewIndiaExcellTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "FGII")
                    {
                        Fileinfo.TName = "FutureGNlIndiaTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "KMGI")
                    {
                        Fileinfo.TName = "KotakTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "ACKO")
                    {
                        Fileinfo.TName = "AckoTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "NBHI")
                    {
                        Fileinfo.TName = "NivaBupaTransaction";
                    }
                    btnBrowse.Enabled = false;
                }
                else
                {
                    btnBrowse.Enabled = true;
                    btnCancel.Enabled = true;
                    btnConvert.Enabled = false;
                }
            }
            else
            {
                if (DDInsurance.SelectedValue.ToString() == "0")
                {
                    MessageBox.Show("Please select Insurance");
                }
                //else if (DDLocation.SelectedValue.ToString() == "0")
                //{
                //    MessageBox.Show("Please select Office Location");
                //}
                else if (DDsales.SelectedValue.ToString() == "0")
                {
                    MessageBox.Show("Please select Sales Generated By");
                }
                else if (DDService.SelectedValue.ToString() == "0")
                {
                    MessageBox.Show("Please select Serviced By");
                }
                else if (DDMonth.SelectedIndex == -1 || DDMonth.SelectedIndex == 0)
                {
                    MessageBox.Show("Please select Report Month");
                }
                btnConvert.Enabled = false;
                btnCancel.Enabled = false;
                btnBrowse.Enabled = true;
            }
        }

        static string Filename, Filenamewithext, Filewithext, name, TranID, BatchID, NoRecord;

        private void DDService_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (DDService.SelectedValue.ToString() != "0")
            {
                btnBrowse.Enabled = true;
            }
            else
            {
                btnBrowse.Enabled = false;
            }
        }

        private void DDLocation_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (DDLocation.SelectedValue.ToString() == "05")
            {
                DDsales.SelectedValue = "S74";
                DDService.SelectedValue = "R57";
            }
            else
            {
                DDsales.SelectedValue = "0";
                DDService.SelectedValue = "0";
            }
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            string promptValue = ShowDialog("Batch");
            if (promptValue != "")
            {
                if (Fileinfo.InsurerCode == "UIIC")
                {
                    Fileinfo.Insurer = "UIIC,United India Insurance";
                }
                else if (Fileinfo.InsurerCode == "NIAC")
                {
                    Fileinfo.Insurer = "NIAC,New India Assurance Company Ltd.";
                }
                else if (Fileinfo.InsurerCode == "FGII")
                {
                    Fileinfo.Insurer = "FGII,Future General India Insurance Co.Ltd.";
                }
                else if (Fileinfo.InsurerCode == "KMGI")
                {
                    Fileinfo.Insurer = "KMGI,Kotak Mahindra General Insurance Co.Ltd.";
                }
                else if (Fileinfo.InsurerCode == "ACKO")
                {
                    Fileinfo.Insurer = "ACKO,Acko General Insurance  Co.Ltd.";
                }
                else if (Fileinfo.InsurerCode == "NBHI")
                {
                    Fileinfo.Insurer = "NBHI,Niva Bupa Health Insurance Co.Ltd.";
                }
                Fileinfo.BatchId = promptValue.Substring(0, promptValue.IndexOf(","));
                Fileinfo.Filename = promptValue.Substring(promptValue.IndexOf(",") + 1);
                EditForm obj = new EditForm();
                obj.Show();
                obj.WindowState = FormWindowState.Normal;
            }
        }
        private void linkLabel2_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
        {
            if (Fileinfo.InsurerCode == "UIIC")
            {
                Fileinfo.Insurer = "UIIC,United India Insurance";
            }
            else if (Fileinfo.InsurerCode == "NIAC")
            {
                Fileinfo.Insurer = "NIAC,New India Assurance Company Ltd.";
            }
            else if (Fileinfo.InsurerCode == "FGII")
            {
                Fileinfo.Insurer = "FGII,Future General India Insurance Co.Ltd.";
            }
            else if (Fileinfo.InsurerCode == "KMGI")
            {
                Fileinfo.Insurer = "KMGI,Kotak Mahindra General Insurance Co. Ltd.";
            }
            else if (Fileinfo.InsurerCode == "ACKO")
            {
                Fileinfo.Insurer = "ACKO,Acko General Insurance  Co.Ltd.";
            }
            else if (Fileinfo.InsurerCode == "NBHI")
            {
                Fileinfo.Insurer = "NBHI,Niva Bupa Health Insurance Co.Ltd.";
            }
            Fileinfo.BatchId = BatchID;
            EditForm obj = new EditForm();
            obj.Show();
            obj.WindowState = FormWindowState.Normal;
        }

        private void btnLogout_Click(object sender, EventArgs e)
        {
            Login obj = new Login();
            obj.Show();
            this.Close();
        }

        private void kryptonButton2_Click(object sender, EventArgs e)
        {
            Home obj = new Home();
            obj.Show();
            this.Close();
        }

        private void btnConvert_Click(object sender, EventArgs e)
        {
            try
            {
                btnCancel.Enabled = false;
                var confirmResult = MessageBox.Show("Excel file to be uploaded must meet the guidelines below:\n" +
                    "\nExcel file should be in XLS or XLSX format.Any other file extension (XLT,XLM) will be REJECTED.\n" +
                    "The excel file may be rejected incase of Column name/address mismatch with this ViewSample format.\n" +
                    "Excel file should not contain any empty rows / columns.\n" +
                    "Input file data should be on the first sheet of the Excel.\n" +
                    "\nHave you got the right document?", "Confirm",
                                     MessageBoxButtons.YesNo);
                if (confirmResult == DialogResult.Yes)
                {
                    DateTime a = DateTime.Now;
                    lblmsg.Text = "Please wait.......";
                    lblmsg.Refresh();
                    btnBrowse.Enabled = false;
                    btnConvert.Enabled = false;
                    linkLabel2.Enabled = false;
                    DDInsurance.Enabled = false;
                    DDLocation.Enabled = false;
                    DDsales.Enabled = false;
                    DDService.Enabled = false;
                    DDSupport.Enabled = false;
                    DDMonth.Enabled = false;

                    DDInsurance.SelectionLength = 0;
                    DDLocation.SelectionLength = 0;
                    DDsales.SelectionLength = 0;
                    DDService.SelectionLength = 0;
                    DDSupport.SelectionLength = 0;
                    DDMonth.SelectionLength = 0;

                    if (Fileinfo.InsurerCode == "UIIC")
                    {
                        ProcName = "SP_UnitedExcelTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "NIAC")
                    {
                        ProcName = "SP_NewIndiaExcelTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "FGII")
                    {
                        ProcName = "SP_FutureGNlIndiaTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "KMGI")
                    {
                        ProcName = "SP_KotakExcelTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "ACKO")
                    {
                        ProcName = "SP_AckoExcelTransaction";
                    }
                    else if (Fileinfo.InsurerCode == "NBHI")
                    {
                        ProcName = "SP_NivaExcelTransaction";
                    }
                    SQLProcs sql = new SQLProcs();
                    DataSet ds1 = new DataSet();
                    ds1 = sql.SQLExecuteDataset(ProcName,
                                  new SqlParameter { ParameterName = "@Imode", Value = 7 },
                                  new SqlParameter { ParameterName = "@Filename", Value = Fileinfo.Filename }
                         );
                    if (ds1 != null && ds1.Tables.Count > 0 && ds1.Tables[0].Rows.Count > 0)
                    {
                        Result = ds1.Tables[0].Rows[0]["Result"].ToString();
                    }
                    else
                    {
                        Result = "Not Exists";
                    }
                    if (Result == "Not Exists")
                    {
                        name = Filepath;


                        string filewithourext = Filename + DateTime.Now.AddDays(0).ToString("ddMMyyyyhhmmss");
                        filewithourext = Dir + "\\" + filewithourext;

                        DataSet ds = new DataSet();
                        ds = sql.SQLExecuteDataset(ProcName,
                                     new SqlParameter { ParameterName = "@Imode", Value = 2 }
                            );
                        if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                        {
                            TranID = ds.Tables[0].Rows[0]["TranID"].ToString();
                        }
                        else
                        {
                            TranID = "0";
                        }


                        string Insurance = DDInsurance.Text.ToString();
                        string Salesby = DDsales.Text.ToString();
                        string Serviceby = DDService.Text.ToString();
                        string location = DDLocation.Text.ToString();
                        string Support = DDSupport.Text.ToString();
                        string Rmonth = DDMonth.Text.ToString();
                        RDate = DateTime.Now.AddDays(0).ToString("dd-MM-yyyy");
                        //if (Fileinfo.ReportId == "NIX1")
                        //{
                        //    //IWorkbook workbook = OpenWorkBook(name);

                        //    //ISheet sheet1 = workbook.GetSheet("Sheet1");

                        //    //DeleteRows(sheet1);

                        //    //SaveWorkBook(workbook, name);
                        //    //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                        //    //UnitedInsurence.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);

                        //}
                        Microsoft.Office.Interop.Excel.Application oExcel = new Microsoft.Office.Interop.Excel.Application();
                        Microsoft.Office.Interop.Excel.Workbook WB = oExcel.Workbooks.Open(name);

                        Microsoft.Office.Interop.Excel.Worksheet sheet = WB.ActiveSheet;
                        if (Fileinfo.ReportId == "UIIX")
                        {
                            //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                           UnitedInsurence.InsertExcelTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);

                        }
                        else if (Fileinfo.ReportId == "NIX1")
                        {
                            //InsertTransaction1(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            //NewIndiaInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "NIX2")
                        {
                            //InsertTransaction2(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            //NewIndiaInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "NIX3")
                        {
                            //InsertTransaction3(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            //NewIndiaInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "FGIX")
                        {
                            //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            FutureGNlIndiaInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "KMGX")
                        {
                            //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            KotakTransaction.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "ACKX")
                        {
                            //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            AckoInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        else if (Fileinfo.ReportId == "NBHX")
                        {
                            //InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth);
                            NivaInsurance.InsertTransaction(WB, TranID, RDate, Insurance, Salesby, Serviceby, location, Support, Rmonth, strconn);
                        }
                        oExcel.Workbooks.Close();
                        GetBachid_NoRecord(ProcName, TranID);


                        DateTime b = DateTime.Now;
                        TimeSpan diff = b - a;
                        var Sec = String.Format("{0}", diff.Seconds);
                        lblmsg.Text = "";

                        DDInsurance.SelectionLength = 0;
                        DDLocation.SelectionLength = 0;
                        DDsales.SelectionLength = 0;
                        DDService.SelectionLength = 0;
                        DDSupport.SelectionLength = 0;
                        DDMonth.SelectionLength = 0;

                        //if (Fileinfo.ReportId == "ILG1" && Fileinfo.Type == "Terrorism")
                        //{
                        //    lblSuccMsg.Text = "          Smart Read completed in " + Sec + " Seconds.";
                        //}
                        //else
                        //{
                        lblSuccMsg.Text = "                     SmartRead Done in " + Sec + " Seconds.\n" +
                                             "            Batch ID: " + BatchID + " ,Number of records: " + NoRecord;

                        var confirmExportResult = MessageBox.Show("Data is now in database. Do you wish to get it in Excel format for your checking?", "Confirm",
                                        MessageBoxButtons.YesNo);
                        if (confirmExportResult == DialogResult.Yes)
                        {
                            ExcelExport(ProcName);
                        }
                        else
                        {
                            lblmsg1.ForeColor = System.Drawing.Color.DarkGreen;
                            lblmsg1.Text = "You can check the data through another Menu Option.";
                        }
                        linkLabel2.Enabled = true;
                        linkLabel2.Text = "Click here to Edit the records if needed.";
                        //}


                        DDInsurance.SelectionLength = 0;
                        DDLocation.SelectionLength = 0;
                        DDsales.SelectionLength = 0;
                        DDService.SelectionLength = 0;
                        DDSupport.SelectionLength = 0;
                        DDMonth.SelectionLength = 0;
                        btnCancel.Enabled = true;
                        if (File.Exists(DelFile))
                        {
                            File.Delete(DelFile);
                        }
                    }
                    else
                    {
                        lblmsg.Text = "";
                        lblmsg.Refresh();
                        MessageBox.Show("Given file's BDS is already exists in the database.", "Warning!");
                        btnCancel.Enabled = true; btnBrowse.Enabled = true;
                        DDInsurance.SelectionLength = 0;
                        DDLocation.SelectionLength = 0;
                        DDsales.SelectionLength = 0;
                        DDService.SelectionLength = 0;
                        DDSupport.SelectionLength = 0;
                        DDMonth.SelectionLength = 0;
                    }
                }
                else
                {
                    btnCancel.Enabled = true;
                }
            }
            catch (Exception ex)
            {
                lblmsg.Text = "";
                lblmsg.Refresh();
                InsertException(ex.Message);
                lblmsg1.Text = "                        SmartRead data extraction failed." +
                               "\n Possible reasons:Wrong document,Column mismatch or empty rows" +
                               "\n                           Please check the source file.";
                lblmsg1.ForeColor = System.Drawing.Color.Red;
                btnCancel.Enabled = true;
                DDMonth.SelectedIndex = 0;
                DDInsurance.SelectedValue = 0;
                DDLocation.SelectedValue = 0;
                DDsales.SelectedValue = 0;
                DDService.SelectedValue = 0;
                DDSupport.SelectedValue = 0;
                //DDMonth.SelectedText = "";
                DDInsurance.Enabled = true;
                DDLocation.Enabled = true;
                DDsales.Enabled = true;
                DDService.Enabled = true;
                DDSupport.Enabled = true;
                DDMonth.Enabled = true;
                DDInsurance.SelectionLength = 0;
                DDLocation.SelectionLength = 0;
                DDsales.SelectionLength = 0;
                DDService.SelectionLength = 0;
                DDSupport.SelectionLength = 0;
                DDMonth.SelectionLength = 0;
            }
        }

        
        public AckoInsurence()
        {
            InitializeComponent();
            lblUser.Text = LoginInfo.UserID;
            if (Fileinfo.ReportId == "UIIX")
            {
                lblHeader.Text = "UIIC (United India Insurance) - Report Id: UIIX";
            }
            else if (Fileinfo.ReportId == "NIX1")
            {
                lblHeader.Text = "NIAC (New India Assurance Company Ltd.) - Report Id: NIX1";
            }
            else if (Fileinfo.ReportId == "NIX2")
            {
                lblHeader.Text = "NIAC (New India Assurance Company Ltd.) - Report Id: NIX2";
            }
            else if (Fileinfo.ReportId == "NIX3")
            {
                lblHeader.Text = "NIAC (New India Assurance Company Ltd.) - Report Id: NIX3";
            }
            else if (Fileinfo.ReportId == "FGIX")
            {
                lblHeader.Text = "FGII (Future General India Insurance Co.Ltd.) - Report Id: FGIX";
            }
            else if (Fileinfo.ReportId == "KMGX")
            {
                lblHeader.Text = "KMGI(Kotak Mahindra General Insurance Co.Ltd.)-Report Id: KMGX";
            }
            else if (Fileinfo.ReportId == "ACKX")
            {
                lblHeader.Text = "ACKO (Acko General Insurance Co.Ltd.) - Report Id: ACKX";
            }
            else if (Fileinfo.ReportId == "NBHX")
            {
                lblHeader.Text = "NBHI (Niva Bupa Health Insurance Co.Ltd.) - Report Id: NBHX";
            }
            BindDDInsurance();
            BindDDSales();
            BindDDService();
            BindDDLocation();
            BindDDSupport();
            DDMonth.Select();
            TimeUpdater();
        }

        private void kryptonButton3_Click(object sender, EventArgs e)
        {

            if (Fileinfo.ReportId == "FGIX") //Future General India Insurance Co. Ltd..
            {
                FutureGeneralSample obj = new FutureGeneralSample();
                obj.Show();
            }
            if (Fileinfo.ReportId == "KMGX") //Kotak Mahindra General Insurance Co. Ltd.
            {
                Kotaksample obj = new Kotaksample();
                obj.Show();
            }
            if (Fileinfo.ReportId == "ACKX") //Acko General Insurance  Co.Ltd.
            {
                AckoSample obj = new AckoSample();
                obj.Show();
            }
            if (Fileinfo.ReportId == "NBHX") //Niva Bupa Health Insurance Co. Ltd. 
            {
                NivaSample obj = new NivaSample();
                obj.Show();
            }
            if (Fileinfo.ReportId == "UIIX") // United India Insurance Co Ltd (Excel).
            {
                UnitedExcelSample obj = new UnitedExcelSample();
                obj.Show();
            }
        }

        async void TimeUpdater()
        {
            while (true)
            {
                lblTimer.Text = DateTime.Now.ToString("dd-MM-yyyy hh:mm:ss tt");
                await Task.Delay(1000);
            }
        }
        //private static IWorkbook OpenWorkBook(string workBookName)
        //{
        //    foreach (var process in Process.GetProcessesByName(workBookName)) //whatever you need to close 
        //    {
        //        //if (process.MainWindowTitle.Contains("test.xlsx"))
        //        //{
        //            process.Kill();
        //            break;
        //       // }
        //    }
        //    using (FileStream file = new FileStream(workBookName, FileMode.Open, FileAccess.Read))
        //    {
        //        return new XSSFWorkbook(file);
        //    }
        //}
        //private static void SaveWorkBook(IWorkbook workbook, string workBookName)
        //{
        //    string newFileName = System.IO.Path.ChangeExtension(workBookName, "new.xlsx");
        //    using (FileStream file = new FileStream(newFileName, FileMode.Create, FileAccess.Write))
        //    {
        //        workbook.Write(file);
        //    }

        //    string backupFileName = System.IO.Path.ChangeExtension(workBookName, "bak.xlsx");
        //    File.Replace(newFileName, workBookName, backupFileName);
        //}
        //public static void DeleteRows(ISheet sheet)
        //{
        //    var num = sheet.LastRowNum;
        //    int termsList1 = -1, termsList2 = -1, termsList3 = -1, termsList4 = -1;
        //    for (int rowIndex = sheet.LastRowNum; rowIndex >= 0; rowIndex--)
        //    {
        //        IRow row = sheet.GetRow(rowIndex);
        //        if (row == null) continue;
        //        ICell cell2 = row.GetCell(0);
        //        if (cell2 != null && cell2.StringCellValue.Contains("Brokerage Invoice Report"))
        //        {
        //                termsList1 = rowIndex;
        //        }
        //        ICell cell3 = row.GetCell(0);
        //        if (cell3 != null && cell3.StringCellValue.Contains("Invoice Number"))
        //        {
        //            if (rowIndex != 7)
        //            {
        //                termsList2 = rowIndex;
        //            }
        //        }
        //        if (termsList1 != -1 && termsList2 != -1)
        //        {

        //            for (int list = termsList2; list >= termsList1; list--)
        //            {
        //                IRow row1 = sheet.GetRow(list);
        //                sheet.ShiftRows(row1.RowNum + 1, sheet.LastRowNum, -1);
        //            }
        //            termsList2 = -1;
        //            termsList1 = -1;
        //        }
        //        ICell cell4 = row.GetCell(0);
        //        if (cell4 != null && cell4.StringCellValue.Contains("Total") && !cell4.StringCellValue.Contains("Grand Total"))
        //        {
        //            termsList3 = rowIndex;
        //        }
        //            termsList4 = num;

        //        if (termsList3 != -1 && termsList4 != -1)
        //        {

        //            for (int list = termsList4; list >= termsList3; list--)
        //            {
        //                IRow row1 = sheet.GetRow(list);
        //                sheet.ShiftRows(row1.RowNum + 1, sheet.LastRowNum, -1);
        //            }
        //            termsList4 = -1;
        //            termsList3 = -1;
        //        }
        //    }
        //    //for (int rowIndex = sheet.LastRowNum; rowIndex >= 0; rowIndex--)
        //    //{
        //    //    IRow row = sheet.GetRow(rowIndex);
        //    //    if (row == null) continue;
        //    //    ICell cell4 = row.GetCell(0);
        //    //    if (cell4 != null && cell4.StringCellValue.Contains("Department Total"))
        //    //    {
        //    //        termsList3 = rowIndex;
        //    //    }
        //    //    ICell cell5 = row.GetCell(7);
        //    //    ICell cell6 = row.GetCell(8);
        //    //    if ((cell5 != null && cell5.StringCellValue.Contains("Net Payable"))
        //    //        || (cell6 != null && cell6.StringCellValue.Contains("Net Payable")))
        //    //    {
        //    //        termsList4 = rowIndex;
        //    //    }
        //    //    if (termsList3 != -1 && termsList4 != -1)
        //    //    {

        //    //        for (int list = termsList4; list >= termsList3; list--)
        //    //        {
        //    //            IRow row1 = sheet.GetRow(list);
        //    //            sheet.ShiftRows(row1.RowNum + 1, sheet.LastRowNum, -1);
        //    //        }
        //    //        termsList4 = -1;
        //    //        termsList3 = -1;
        //    //    }

        //    //    ICell cell = row.GetCell(0);
        //    //    if (cell != null && cell.StringCellValue.Contains("Office"))
        //    //    {
        //    //        if (rowIndex != 0)
        //    //        {
        //    //            sheet.ShiftRows(row.RowNum + 1, sheet.LastRowNum, -1);
        //    //        }
        //    //    }
        //    //}
        //}
        private void btnCancel_Click(object sender, EventArgs e)
        {
            Filepath = "";
            Dir = "";
            Filename = "";
            txtfile.Text = "";
            linkLabel2.Text = "";
            btnBrowse.Enabled = false;
            btnCancel.Enabled = false;
            btnConvert.Enabled = false;
            linkLabel2.Enabled = false;
            txtfile.Text = "Select pdf document";
            txtfile.ForeColor = System.Drawing.Color.Gray;
            lblmsg1.Text = "";
            lblSuccMsg.Text = "";
            DDInsurance.SelectedValue = 0;
            DDLocation.SelectedValue = 0;
            DDsales.SelectedValue = 0;
            DDService.SelectedValue = 0;
            DDSupport.SelectedValue = 0;
            DDMonth.SelectedIndex = 0;
            DDInsurance.Enabled = true;
            DDLocation.Enabled = true;
            DDsales.Enabled = true;
            DDService.Enabled = true;
            DDSupport.Enabled = true;
            DDMonth.Enabled = true;
            DDMonth.Select();
        }
        public void GetBachid_NoRecord(string ProcName, string TranID)
        {
            try
            {
                SQLProcs sql = new SQLProcs();
                DataSet ds = new DataSet();

                ds = sql.SQLExecuteDataset(ProcName,
                     new SqlParameter { ParameterName = "@Imode", Value = 4 },
                     new SqlParameter { ParameterName = "@TranID", Value = TranID }
                     );

                if (ds != null && ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
                {
                    BatchID = ds.Tables[0].Rows[0]["BatchID"].ToString();
                }
                else
                {
                    BatchID = "";
                }

                DataSet dsR = new DataSet();
                dsR = sql.SQLExecuteDataset(ProcName,
                     new SqlParameter { ParameterName = "@Imode", Value = 5 },
                     new SqlParameter { ParameterName = "@BatchID", Value = BatchID },
                     new SqlParameter { ParameterName = "@Filename", Value = Fileinfo.Filename },
                     new SqlParameter { ParameterName = "@version", Value = LoginInfo.version },
                     new SqlParameter { ParameterName = "@UserId", Value = LoginInfo.UserID }
                     );
                if (dsR != null && dsR.Tables.Count > 0 && dsR.Tables[0].Rows.Count > 0)
                {
                    NoRecord = dsR.Tables[0].Rows[0]["NoRecord"].ToString();
                }
                else
                {
                    NoRecord = "";
                }
            }
            catch (Exception ex)
            {

                InsertException(ex.Message);
            }
        }
        public void InsertException(string exception)
        {
            SQLProcs sql = new SQLProcs();
            sql.ExecuteSQLNonQuery("SP_Login",
                     new SqlParameter { ParameterName = "@Imode", Value = 10 },
                     new SqlParameter { ParameterName = "@Exception", Value = exception },
                     new SqlParameter { ParameterName = "@InsurerCode", Value = Fileinfo.InsurerCode },
                     new SqlParameter { ParameterName = "@ReportCode", Value = Fileinfo.ReportId },
                     new SqlParameter { ParameterName = "@UserId", Value = LoginInfo.UserID }
                     );
        }
        public void ExcelExport(string Pname)
        {
            try
            {
                string pathUser = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile);
                string pathDownload = Path.Combine(pathUser, "Downloads\\");

                SQLProcs sql = new SQLProcs();
                DataSet ResultsTable = new DataSet();

                ResultsTable = sql.SQLExecuteDataset(Pname,
               new SqlParameter { ParameterName = "@Imode", Value = 3 },
               new SqlParameter { ParameterName = "@TranID", Value = TranID }
               );

                string date = DateTime.Now.ToString();
                date = date.Replace("/", "_").Replace(":", "").Replace(" ", "").Replace("AM", "").Replace("PM", "");

                string FileName = Fileinfo.ReportId + "_" + date + ".xlsx";

                using (ClosedXML.Excel.XLWorkbook wb = new ClosedXML.Excel.XLWorkbook())
                {
                    for (int i = 0; i < ResultsTable.Tables.Count; i++)
                    {
                        wb.Worksheets.Add(ResultsTable.Tables[i], ResultsTable.Tables[i].TableName);
                    }
                    wb.Style.Alignment.Horizontal = ClosedXML.Excel.XLAlignmentHorizontalValues.Center;
                    wb.Style.Font.Bold = true;
                    string path = pathDownload + "\\" + FileName;
                    wb.SaveAs(path);

                    sql.SQLExecuteDataset(Pname,
                    new SqlParameter { ParameterName = "@Imode", Value = 6 },
                    new SqlParameter { ParameterName = "@BatchID", Value = BatchID },
                    new SqlParameter { ParameterName = "@version", Value = LoginInfo.version },
                    new SqlParameter { ParameterName = "@UserId", Value = LoginInfo.UserID }
                    );

                    lblmsg1.ForeColor = System.Drawing.Color.Green;
                    lblmsg1.Text = "SmartRead data downloaded as XLSX file for your verification." +
                                   "\n            (File Name:" + FileName + ")";

                }
            }
            catch (Exception ex)
            {
                //return ex.Message;
                lblSuccMsg.Text = "";
                InsertException(ex.Message);
                lblmsg1.Text = "Data export failed.";
                lblmsg1.ForeColor = System.Drawing.Color.Red;
                linkLabel2.Text = "";
                linkLabel2.Enabled = false;
            }
        }
        public string ShowDialog(string caption)
        {
            var promptValue = "";
            Form prompt = new Form()
            {
                Width = 600,
                Height = 200,
                FormBorderStyle = FormBorderStyle.FixedDialog,
                BackColor = System.Drawing.Color.White,
                Text = caption,
                StartPosition = FormStartPosition.CenterScreen,
                MinimizeBox = false,
                MaximizeBox = false
            };
            Label textLabel = new Label() { Left = 50, Top = 30, Text = "Batch" };
            ComboBox CB = new ComboBox() { Left = 100, Top = 30, Width = 450 };
            Label lblErmsg = new Label() { Left = 50, Top = 50, Width = 300 };
            Button confirmation = new Button() { Text = "Ok", Left = 220, Width = 80, Top = 100, DialogResult = DialogResult.OK, Enabled = false };
            Button confirmation1 = new Button() { Text = "Cancel", Left = 320, Width = 80, Top = 100, DialogResult = DialogResult.Cancel };
            textLabel.Font = new Font("Verdana", 11);
            CB.Font = new Font("Verdana", 9);
            lblErmsg.Font = new Font("Verdana", 9);
            lblErmsg.ForeColor = System.Drawing.Color.Red;
            confirmation.Font = new Font("Verdana", 9);
            confirmation1.Font = new Font("Verdana", 9);
            DataRow dr;
            string com = "select distinct(Inv_No) as No,Inv_No+','+[Filename] as Name from BDSMaster where InsurerCode = '" + Fileinfo.InsurerCode + "' and ReportCode = '" + Fileinfo.ReportId + "'";
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            CB.ValueMember = "No";
            CB.DisplayMember = "Name";
            CB.DataSource = dt;
            CB.AutoCompleteMode = AutoCompleteMode.Suggest;
            CB.AutoCompleteSource = AutoCompleteSource.ListItems;

            //confirmation.Click += (sender, e) => { prompt.Close(); };
            confirmation1.Click += (sender, e) => { prompt.Close(); };
            prompt.Controls.Add(CB);
            prompt.Controls.Add(confirmation);
            prompt.Controls.Add(confirmation1);
            prompt.Controls.Add(textLabel);
            prompt.AcceptButton = confirmation;

            CB.SelectedIndexChanged += (sender, e) =>
            {
                if (CB.SelectedValue.ToString() != "0")
                {
                    confirmation.Enabled = true;
                }
                else
                {
                    confirmation.Enabled = false;
                }
            };
            if (prompt.ShowDialog() == DialogResult.OK && CB.SelectedValue.ToString() != "0")
            {
                // promptValue = CB.SelectedValue.ToString();
                promptValue = CB.Text;
            }
            else if (prompt.ShowDialog() == DialogResult.Cancel)
            {
                promptValue = "";
                prompt.Close();
            }
            return promptValue;
        }
        private string strconn = ConfigurationManager.ConnectionStrings["IDP"].ToString();
        public void BindDDInsurance()
        {
            DataRow dr; var groupby = ""; string com = "";
            if (Fileinfo.InsurerCode == "UIIC")
            {
                groupby = "UN";
            }
            else if (Fileinfo.InsurerCode == "NIAC")
            {
                groupby = "NE";
            }
            else if (Fileinfo.InsurerCode == "FGII")
            {
                groupby = "FU";
            }
            else if (Fileinfo.InsurerCode == "KMGI")
            {
                groupby = "KO";
            }
            else if (Fileinfo.InsurerCode == "ACKO")
            {
                groupby = "AC";
            }
            else if (Fileinfo.InsurerCode == "NBHI")
            {
                groupby = "NI";
            }
            //string com = "select Code,InsurerCode + ','+ UPPER(LEFT(Description, 1)) + LOWER(RIGHT(Description, LEN(Description) - 1)) as Description from tblBRInsurancelkup where GroupBy = 'UN' and Code != '' order by Description asc";
            //string com = "select Code,InsurerCode + ',' + Code +' '+ UPPER(LEFT(Description, 1)) + LOWER(RIGHT(Description, LEN(Description) - 1)) as Description from tblBRInsurancelkup where GroupBy = 'UN' and Code != '' order by Description asc";

            com = "select ROW_NUMBER() OVER (ORDER BY (SELECT 1)) as Code,InsurerCode + ',' + UPPER(LEFT(Description, 1)) + LOWER(RIGHT(Description, LEN(Description) - 1)) as Description from tblBRInsurancelkup where GroupBy = '" + groupby + "' order by Description asc";
            
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            DDInsurance.ValueMember = "Code";
            DDInsurance.DisplayMember = "Description";
            DDInsurance.DataSource = dt;

        }
        public void BindDDSupport()
        {
            DataRow dr;
            string com = "select CodeValue,ShortDescription from tblLookup where Codeid = 'BST' order by ShortDescription asc";
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            DDSupport.ValueMember = "CodeValue";
            DDSupport.DisplayMember = "ShortDescription";
            DDSupport.DataSource = dt;
        }
        public void BindDDSales()
        {
            DataRow dr;
            string com = "select Code,Description from tblSalesByLkup order by Description asc";
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            DDsales.ValueMember = "Code";
            DDsales.DisplayMember = "Description";
            DDsales.DataSource = dt;
        }
        public void BindDDService()
        {
            DataRow dr;
            string com = "select Code,Description from tblServicedByLkup order by Description asc";
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            DDService.ValueMember = "Code";
            DDService.DisplayMember = "Description";
            DDService.DataSource = dt;
        }
        public void BindDDLocation()
        {
            DataRow dr;
            string com = "select CodeValue,ShortDescription from tblLookup where Codeid = 'OL' order by ShortDescription asc";
            SqlDataAdapter adpt = new SqlDataAdapter(com, strconn);
            DataTable dt = new DataTable();
            adpt.Fill(dt);
            dr = dt.NewRow();
            dr.ItemArray = new object[] { 0, "" };
            dt.Rows.InsertAt(dr, 0);

            DDLocation.ValueMember = "CodeValue";
            DDLocation.DisplayMember = "ShortDescription";
            DDLocation.DataSource = dt;
        }

        //public static void InsertTransaction(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //Niva Bupa Health Insurance Co. Ltd. 
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row;
        //    for (int i = 2; i <= lastrow; i++)
        //    {
        //        var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = ""; var Premium_Amt = "";
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 4]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            //InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 1]).Value).Replace("\n", "").TrimStart();
        //            //var Client_N_E = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value);
        //            //var Endno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            //if (Endno == null || Endno == "" || Endno == " ")
        //            //{
        //            //    Policy_Endorsement = "Policy";
        //            //}
        //            //else
        //            //{
        //            //    PolicyNo = PolicyNo + "/" + Endno;
        //            //    Policy_Endorsement = "Endorsement";
        //            //}

        //            //var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 18]).Value;
        //            //var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 17]).Value;
        //            //var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 19]).Value;
        //            //if (Endo_Effective_Date != null && Endo_Effective_Date != "" && Endo_Effective_Date != " ")
        //            //{
        //            //    int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            //    if (ENdolen > 11)
        //            //    {
        //            //        Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            //    }
        //            //}
        //            //int Efflen = Convert.ToString(Effective_Date).Length;
        //            //if (Efflen > 11)
        //            //{
        //            //    Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            //int ENDlen = Convert.ToString(END_Date).Length;
        //            //if (ENDlen > 11)
        //            //{
        //            //    END_Date = END_Date.ToString("dd/MM/yyyy");
        //            //}
        //            Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value);
        //            if (Premium_Amt != null)
        //            {
        //                Premium_Amt = Premium_Amt.Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            }
        //            //Premium_Amt = Convert.ToString(Convert.ToDecimal(PA1) + Convert.ToDecimal(PA2));
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 45]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            if (Revenue_Amt != null)
        //            {
        //                Revenue_Amt = Revenue_Amt.Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            }
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 10]).Text);
        //            if (Revenue_Pcnt != null)
        //            {
        //                Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();
        //            }
        //            Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 19]).Value);
        //            var offlocation = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 17]).Value);
        //            if (InsuredName.ToUpper().Contains("LIMITED") || InsuredName.ToUpper().Contains("LTD"))
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }

        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = "0";
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_NivaExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       //new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       //new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       //new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = offlocation },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "NBHX" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "NBHX" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "Niva Bupa Health Insurance Co.Ltd." }
        //                       );
        //        }
        //    }
        //}

        //public static void InsertTransaction(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //Acko General Insurance  Co.Ltd.
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row; 
        //    for (int i = 3; i <= lastrow; i++)
        //    {
        //        var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = "";
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 3]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            //InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 1]).Value).Replace("\n", "").TrimStart();
        //            //var Endorsementno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value);

        //            //var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 2]).Value;
        //            //var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value;
        //            //int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            //if (ENdolen > 11)
        //            //{
        //            //    Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            int Efflen = Convert.ToString(Effective_Date).Length;
        //            if (Efflen > 11)
        //            {
        //                Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            //int ENDlen = Convert.ToString(END_Date).Length;
        //            //if (ENDlen > 11)
        //            //{
        //            //    END_Date = END_Date.ToString("dd/MM/yyyy");
        //            //}
        //            var Client_N_E = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 4]).Value.Replace("\n", "").TrimStart();
        //            if (Client_N_E == "FRESH")
        //            {
        //                Client_N_E = "New Client";
        //                New_Renewal = "New Policy";
        //            }
        //            else
        //            {
        //                Client_N_E = "Existing Client";
        //                New_Renewal = "Renewal Policy";
        //            }
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 9]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 10]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value);
        //            if (InsuredName.Contains("LIMITED") || InsuredName.Contains("LTD"))
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }

        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_AckoExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       //new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       //new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = location },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "ACKX" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "ACKX" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "Acko General Insurance Co.Ltd." }
        //                       );
        //        }
        //    }
        //}

        //public static void InsertTransaction(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //Kotak Mahindra General Insurance Co. Ltd.
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row;
        //    for (int i = 2; i <= lastrow; i++)
        //    {
        //        var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = ""; var Premium_Amt = "";
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 24]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            //InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value).Replace("\n", "").TrimStart();
        //            var Client_N_E = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value);
        //            var Endno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            if (Endno == null || Endno == "" || Endno == " ")
        //            {
        //                Policy_Endorsement = "Policy";
        //            }
        //            else
        //            {
        //                PolicyNo = PolicyNo + "/" + Endno;
        //                Policy_Endorsement = "Endorsement";
        //            }

        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 18]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 17]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 19]).Value;
        //            if (Endo_Effective_Date != null && Endo_Effective_Date != "" && Endo_Effective_Date != " ")
        //            {
        //                int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //                if (ENdolen > 11)
        //                {
        //                    Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //                }
        //            }
        //            int Efflen = Convert.ToString(Effective_Date).Length;
        //            if (Efflen > 11)
        //            {
        //                Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            int ENDlen = Convert.ToString(END_Date).Length;
        //            if (ENDlen > 11)
        //            {
        //                END_Date = END_Date.ToString("dd/MM/yyyy");
        //            }
        //            var PA1 = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 46]).Value);
        //            var PA2 = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 43]).Value);
        //            if(PA1 != null)
        //            {
        //                PA1 = PA1.Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            }
        //            if (PA2 != null)
        //            {
        //                PA2 = PA2.Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            }
        //            Premium_Amt = Convert.ToString(Convert.ToDecimal(PA1) + Convert.ToDecimal(PA2));
        //            Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 45]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 70]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 64]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 20]).Value);
        //            var offlocation = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 2]).Value);
        //            if (InsuredName.ToUpper().Contains("LIMITED") || InsuredName.ToUpper().Contains("LTD"))
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }

        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = "0";
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_KotakExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = offlocation },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "KMGX" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "KMGX" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "Kotak Mahindra General Insurance Co. Ltd." }
        //                       );
        //        }
        //    }
        //}
        //public static void InsertTransaction(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //United India Insurance Excel
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row; var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = "";
        //    for (int i = 2; i <= lastrow; i++)
        //    {
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            //InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 13]).Value).Replace("\n", "").TrimStart();
        //            //var Endorsementno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value);

        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value;
        //            //var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value;
        //            int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            if (ENdolen > 11)
        //            {
        //                string date = Convert.ToString(Endo_Effective_Date);
        //                var yy = date.Substring(6, 4);
        //                var MM = date.Substring(3, 2);
        //                var DD = date.Substring(0, 2);
        //                Endo_Effective_Date = DD + "/" + MM + "/" + yy;
        //                //Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            //int Efflen = Convert.ToString(Effective_Date).Length;
        //            //if (Efflen > 11)
        //            //{
        //            //    Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            int ENDlen = Convert.ToString(END_Date).Length;
        //            if (ENDlen > 11)
        //            {
        //                string date = Convert.ToString(END_Date);
        //                var yy = date.Substring(6, 4);
        //                var MM = date.Substring(3, 2);
        //                var DD = date.Substring(0, 2);
        //                END_Date = DD + "/" + MM + "/" + yy;
        //                //END_Date = END_Date.ToString("dd/MM/yyyy");
        //            }
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 10]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            //Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            if (InsuredName.Contains("LIMITED") || InsuredName.Contains("LTD"))
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }

        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_UnitedExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       //new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = location },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "UIIX" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "UIIX" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "United India Insurance" }
        //                       );
        //        }
        //    }
        //}

        //public static void InsertTransaction1(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //New India Assurance Company Limited.Excel
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row; var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = "";
        //    for (int i = 8; i <= lastrow; i++)
        //    {
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            //InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 4]).Value).Replace("\n", "").TrimStart();
        //            //var Endorsementno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value);

        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 10]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 10]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 11]).Value;
        //            //int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            //if (ENdolen > 11)
        //            //{
        //            //    Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            //int Efflen = Convert.ToString(Effective_Date).Length;
        //            //if (Efflen > 11)
        //            //{
        //            //    Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            //int ENDlen = Convert.ToString(END_Date).Length;
        //            //if (ENDlen > 11)
        //            //{
        //            //    END_Date = END_Date.ToString("dd/MM/yyyy");
        //            //}
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 13]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 14]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 12]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            //Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            if (InsuredName.Contains("LIMITED") || InsuredName.Contains("LTD"))
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }

        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_NationalExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = location },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "NIX1" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "NIX1" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "New India Assurance Company Ltd." }
        //                       );
        //        }
        //    }
        //}
        //public static void InsertTransaction2(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //New India Assurance Company Limited.Excel
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row; var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = "";
        //    for (int i = 17; i <= lastrow; i++)
        //    {
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 12]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value;
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value).Replace("\n", "").TrimStart();
        //            //var Endorsementno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value);

        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 18]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 18]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 20]).Value;
        //            //int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            //if (ENdolen > 11)
        //            //{
        //            //    Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            //int Efflen = Convert.ToString(Effective_Date).Length;
        //            //if (Efflen > 11)
        //            //{
        //            //    Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            //}
        //            //int ENDlen = Convert.ToString(END_Date).Length;
        //            //if (ENDlen > 11)
        //            //{
        //            //    END_Date = END_Date.ToString("dd/MM/yyyy");
        //            //}
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 24]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 21]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            //Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);


        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_NationalExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = location },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F2" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "NIX2" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "NIX2" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "New India Assurance Company Ltd." }
        //                       );
        //        }
        //    }
        //}
        //public static void InsertTransaction3(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //New India Assurance Company Limited.Excel
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row; var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var PolicyNo = "";
        //    var Revenue_Pcnt = "" ;var Revenue_Amt = "";
        //    for (int i = 11; i <= lastrow; i++)
        //    {
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 4]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            InsuredType = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 5]).Value;
        //            var PNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 2]).Value);
        //            if(PNo != null && PNo != "" && PNo != " ")
        //            {
        //                PolicyNo = PNo.Replace("\n", "").TrimStart();
        //            }
        //            //var Endorsementno = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 15]).Value);

        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 6]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value;
        //            int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            if (ENdolen > 11)
        //            {
        //                Endo_Effective_Date = Endo_Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            int Efflen = Convert.ToString(Effective_Date).Length;
        //            if (Efflen > 11)
        //            {
        //                Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            int ENDlen = Convert.ToString(END_Date).Length;
        //            if (ENDlen > 11)
        //            {
        //                END_Date = END_Date.ToString("dd/MM/yyyy");
        //            }
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 8]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 9]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            //var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 21]).Text);
        //            //Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();

        //            //Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);


        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_NationalExcelTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = location },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F3" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "NIX3" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "NIX3" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "New India Assurance Company Ltd." }
        //                       );
        //        }
        //    }
        //}

        //public static void InsertTransaction(Microsoft.Office.Interop.Excel.Workbook WB, string TranID, string RDate, string Insurance, string Salesby, string Serviceby, string location, string Support, string Rmonth)
        //{
        //    //Future Generali India Insurance Co. Ltd. Excel
        //    SQLProcs sql = new SQLProcs();
        //    Microsoft.Office.Interop.Excel.Worksheet wks = (Microsoft.Office.Interop.Excel.Worksheet)WB.Worksheets[1];
        //    Microsoft.Office.Interop.Excel.Range lastCell = wks.Cells.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeLastCell, Type.Missing);
        //    int lastrow = lastCell.Row;
        //    for (int i = 2; i <= lastrow; i++)
        //    {
        //        var Terrorism = ""; var Policy_Endorsement = ""; var InsuredType = ""; var Policy_Type = ""; var New_Renewal = ""; var Revenue_Amt = "";
        //        string InsuredName = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 39]).Value;
        //        if (InsuredName != null && InsuredName != "" && InsuredName != " ")
        //        {
        //            InsuredName = InsuredName.Replace("\n", "").TrimStart();
        //            InsuredType = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 36]).Value);
        //            string PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 3]).Value);
        //            if(PolicyNo == null || PolicyNo == "")
        //            {
        //                PolicyNo = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 2]).Value).Replace("\n", "").TrimStart();
        //            }
        //            else
        //            {
        //                PolicyNo = PolicyNo.Replace("\n", "").TrimStart();
        //            }
        //            if (InsuredType == "Corporate Broking")
        //            {
        //                InsuredType = "Corporate";
        //            }
        //            else
        //            {
        //                InsuredType = "Retail";
        //            }                

        //            var Client_N_E = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 13]).Value.Replace("\n", "").TrimStart();
        //            if (Client_N_E == "Endorsement Issue")
        //            {
        //                Policy_Endorsement = "Endorsement";
        //            }
        //            else
        //            {
        //                Policy_Endorsement = "Policy";
        //            }
        //            if (Client_N_E == "New Business Issue")
        //            {
        //                Client_N_E = "New Client";
        //                if (Policy_Endorsement != "Endorsement")
        //                {
        //                    New_Renewal = "New Policy";
        //                }
        //            }
        //            else
        //            {
        //                Client_N_E = "Existing Client";
        //                if (Policy_Endorsement != "Endorsement")
        //                {
        //                    New_Renewal = "Renewal Policy";
        //                }
        //            }
        //            var Endo_Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 31]).Value;
        //            var Effective_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 32]).Value;
        //            var END_Date = ((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 33]).Value;
        //            int ENdolen = Convert.ToString(Endo_Effective_Date).Length;
        //            if (ENdolen == 8)
        //            {
        //                string date = Convert.ToString(Endo_Effective_Date);
        //                var yy = date.Substring(0, 4);
        //                var MM = date.Substring(4, 2);
        //                var DD = date.Substring(6, 2);
        //                Endo_Effective_Date = DD + "/" + MM + "/" + yy;
        //            }
        //            int Efflen = Convert.ToString(Effective_Date).Length;
        //            if (Efflen == 8)
        //            {
        //                string date = Convert.ToString(Effective_Date);
        //                var yy = date.Substring(0, 4);
        //                var MM = date.Substring(4, 2);
        //                var DD = date.Substring(6, 2);
        //                Effective_Date = DD + "/" + MM + "/" + yy;
        //                //Effective_Date = Effective_Date.ToString("dd/MM/yyyy");
        //            }
        //            int ENDlen = Convert.ToString(END_Date).Length;
        //            if (ENDlen == 8)
        //            {
        //                string date = Convert.ToString(END_Date);
        //                var yy = date.Substring(0, 4);
        //                var MM = date.Substring(4, 2);
        //                var DD = date.Substring(6, 2);
        //                END_Date = DD + "/" + MM + "/" + yy;
        //                //END_Date = END_Date.ToString("dd/MM/yyyy");
        //            }
        //            var Premium_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 22]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Terrorism = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 45]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            Revenue_Amt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 23]).Value).Replace(",", "").Replace("(", "").Replace(")", "").Replace("-", "").TrimStart();
        //            var Revenue_Pcnt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 56]).Text);
        //            Revenue_Pcnt = Revenue_Pcnt.Replace("\n", "").Replace("%", "").Replace(",", "").TrimStart();
        //            var RewardAmt = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 75]).Value).Replace(",", "").Replace("(", "").Replace(")", "").TrimStart();
        //            //Policy_Type = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 7]).Value);
        //            var offlocation = Convert.ToString(((Microsoft.Office.Interop.Excel.Range)wks.Cells[i, 18]).Value).Replace("\n", "").TrimStart();
        //            if (Premium_Amt == "" || Premium_Amt == " " || Premium_Amt == null)
        //            {
        //                Premium_Amt = 0;
        //            }
        //            if (Revenue_Amt == "" || Revenue_Amt == " " || Revenue_Amt == null)
        //            {
        //                Revenue_Amt = "0";
        //            }
        //            if (Revenue_Pcnt == "" || Revenue_Pcnt == " " || Revenue_Pcnt == null)
        //            {
        //                Revenue_Pcnt = "0";
        //            }
        //            if (Terrorism == "" || Terrorism == " " || Terrorism == null)
        //            {
        //                Terrorism = "0";
        //            }
        //            if (RewardAmt == "" || RewardAmt == " " || RewardAmt == null)
        //            {
        //                RewardAmt = "0";
        //            }
        //            sql.ExecuteSQLNonQuery("SP_FutureGNlIndiaTransaction",
        //                       new SqlParameter { ParameterName = "@Imode", Value = 1 },
        //                       new SqlParameter { ParameterName = "@RDate", Value = RDate },
        //                       new SqlParameter { ParameterName = "@Rmonth", Value = Rmonth },
        //                       new SqlParameter { ParameterName = "@ClientName", Value = InsuredName },
        //                       new SqlParameter { ParameterName = "@Itype", Value = InsuredType },
        //                       new SqlParameter { ParameterName = "@Policy_No", Value = PolicyNo },
        //                       new SqlParameter { ParameterName = "@Endo_Effective_Date", Value = Endo_Effective_Date },
        //                       new SqlParameter { ParameterName = "@Effective_Date", Value = Effective_Date },
        //                       new SqlParameter { ParameterName = "@END_Date", Value = END_Date },
        //                       new SqlParameter { ParameterName = "@Client_N_E", Value = Client_N_E },
        //                       new SqlParameter { ParameterName = "@New_Renewal", Value = New_Renewal },
        //                       new SqlParameter { ParameterName = "@Revenue_Pct", Value = Revenue_Pcnt },
        //                       new SqlParameter { ParameterName = "@Policy_Type", Value = Policy_Type },
        //                       new SqlParameter { ParameterName = "@Premium_Amt", Value = Premium_Amt },
        //                       new SqlParameter { ParameterName = "@RewardAmt", Value = RewardAmt },
        //                       new SqlParameter { ParameterName = "@TranID", Value = TranID },
        //                       new SqlParameter { ParameterName = "@Revenue_Amt", Value = Revenue_Amt },
        //                       new SqlParameter { ParameterName = "@Terrorism", Value = Terrorism },
        //                       new SqlParameter { ParameterName = "@Insurance", Value = Insurance },
        //                       new SqlParameter { ParameterName = "@Salesby", Value = Salesby },
        //                       new SqlParameter { ParameterName = "@Serviceby", Value = Serviceby },
        //                       new SqlParameter { ParameterName = "@location", Value = offlocation },
        //                       new SqlParameter { ParameterName = "@Support", Value = Support },
        //                       new SqlParameter { ParameterName = "@Policy_Endorsement", Value = Policy_Endorsement },
        //                       new SqlParameter { ParameterName = "@RFormat", Value = "F1" },
        //                       new SqlParameter { ParameterName = "@InvNo", Value = "FGIX" },
        //                       new SqlParameter { ParameterName = "@ReportId", Value = "FGIX" },
        //                       new SqlParameter { ParameterName = "@DocName", Value = "Future General India Insurance Co.Ltd." }
        //                       );
        //        }
        //    }
        //}
    }
}

